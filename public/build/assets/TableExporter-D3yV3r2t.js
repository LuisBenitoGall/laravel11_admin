import{u as $,y as A}from"./OverlayTrigger-D8mD9LjI.js";import{r as j,j as i}from"./app-D2BBDCFC.js";import{E as k,F as _,a as T,b as v}from"./FileSaver.min-Cyq3_crI.js";import{u as g}from"./useTranslation-CVJluGRe.js";const B=j.forwardRef(({bsPrefix:y,className:s,striped:a,bordered:d,borderless:m,hover:b,size:p,variant:x,responsive:f,...u},e)=>{const r=$(y,"table"),n=A(s,r,x&&`${r}-${x}`,p&&`${r}-${p}`,a&&`${r}-${typeof a=="string"?`striped-${a}`:"striped"}`,d&&`${r}-bordered`,m&&`${r}-borderless`,b&&`${r}-hover`),l=i.jsx("table",{...u,className:n,ref:e});if(f){let t=`${r}-responsive`;return typeof f=="string"&&(t=`${t}-${f}`),i.jsx("div",{className:t,children:l})}return l}),F=({fetchData:y,columns:s,filename:a="export"})=>{const d=g(),m=d("datos"),b=d("error_export_excel"),p=d("error_export_pdf"),x=e=>{if(typeof e!="string")return e;const r=document.createElement("div");return r.innerHTML=e,r.textContent||r.innerText||""},f=async()=>{try{let e=await y();if(console.log("TableExporter fetchData result:",e),!Array.isArray(e))if(e&&Array.isArray(e.data))e=e.data;else if(e&&typeof e=="object"){const o=Object.keys(e).find(h=>Array.isArray(e[h]));if(o)e=e[o];else throw new Error("Los datos exportados no son un array.")}else throw new Error("Los datos exportados no son un array.");const r=new k.Workbook,n=r.addWorksheet(m),l=s.map(o=>o.label);n.addRow(l),e.forEach(o=>{const h=s.map(w=>{const E=o[w.key];return w.export==="html"?x(E):E});n.addRow(h)});const t=await r.xlsx.writeBuffer(),c=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});_.saveAs(c,`${a}.xlsx`)}catch(e){alert(b+" "+((e==null?void 0:e.message)||"")),console.error(b,e)}},u=async()=>{try{let e=await y();if(console.log("TableExporter fetchData result:",e),!Array.isArray(e))if(e&&Array.isArray(e.data))e=e.data;else if(e&&typeof e=="object"){const t=Object.keys(e).find(c=>Array.isArray(e[c]));if(t)e=e[t];else throw new Error("Los datos exportados no son un array.")}else throw new Error("Los datos exportados no son un array.");const r=new T,n=s.map(t=>t.label),l=e.map(t=>s.map(c=>{const o=t[c.key];return c.export==="html"?x(o):o}));v(r,{head:[n],body:l,styles:{fontSize:8},headStyles:{fillColor:[91,201,214]}}),r.save(`${a}.pdf`)}catch(e){alert(p+" "+((e==null?void 0:e.message)||"")),console.error(p,e)}};return i.jsx("div",{className:"d-flex align-items-center ms-4",children:i.jsxs("div",{className:"ms-auto d-flex gap-2",children:[i.jsx("button",{onClick:f,className:"btn btn-primary btn-rdn",children:"Excel"}),i.jsx("button",{onClick:u,className:"btn btn-primary btn-rdn",children:"PDF"})]})})};export{F as T,B as a};
