import{r as D,j as e,G as X,X as q,S as Q,A as Y}from"./app-NnFxdXA2.js";import{A as Z}from"./AdminAuthenticatedLayout-DegxA_vr.js";import"./Header-CD84b1cW.js";import"./react-tooltip.min-D40t4uH0.js";import{C as ee}from"./Checkbox-B4_doWxn.js";import{u as U}from"./useTranslation-D4BTlT_h.js";import{F as B}from"./DatePickerToForm-CcYFgCTJ.js";import{I as P}from"./InputError-BTDowRim.js";import{P as ae}from"./PrimaryButton-T50Lbu5Y.js";import{T as te}from"./TabsLocale-B2IfRXwq.js";import{a as se,c as J,g as ne,b as oe,d as z,v as re,e as G,u as ie,S as le,_ as ce}from"./Select-aab027f3.esm-VUTlV0Rx.js";import{T as W}from"./Textarea-DM9ty-tm.js";import{T as H}from"./TextInput-CyElN-IW.js";import"./useSweetAlert-9_SeR-8m.js";import{u as de}from"./useHandleDelete-Cl3Qp92O.js";import"./Sidebar-Drm6TH6A.js";import"./bootstrap.bundle.min-BWQMyn1D.js";import"./NavLink-lbotXNTD.js";import"./Dropdown-CmfadxWU.js";import"./transition-CHBtRj2X.js";import"./OverlayTrigger-Cq1xmpeu.js";import"./floating-ui.dom-CQJTMakY.js";import"./es-CcTx2m4K.js";/* empty css                         */import"./Tabs-C86ks92B.js";import"./defineProperty-DRmM3rRU.js";import"./typeof-QjJsDpFa.js";import"./draftjs-to-html-DOfZqTbi.js";function me({code:n}){const l=U(),[c,p]=D.useState(!1),d=D.useRef(),a=h=>{const f=document.createElement("textarea");f.value=h,f.style.position="fixed",f.style.opacity="0",document.body.appendChild(f),f.select();try{document.execCommand("copy")}catch(O){console.error("Fallback: copia fallida",O)}document.body.removeChild(f)},x=()=>{const h=()=>{p(!0),clearTimeout(d.current),d.current=setTimeout(()=>p(!1),1500)};navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(n).then(h).catch(()=>{a(n),h()}):(a(n),h())};return e.jsxs("div",{className:"wrap-copy",onClick:x,children:[n,c&&e.jsx("div",{className:"copy-tooltip",children:l("texto_copiado")})]})}var pe=["allowCreateWhileLoading","createOptionPosition","formatCreateLabel","isValidNewOption","getNewOptionData","onCreateOption","options","onChange"],K=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",c=arguments.length>1?arguments[1]:void 0,p=arguments.length>2?arguments[2]:void 0,d=String(l).toLowerCase(),a=String(p.getOptionValue(c)).toLowerCase(),x=String(p.getOptionLabel(c)).toLowerCase();return a===d||x===d},R={formatCreateLabel:function(l){return'Create "'.concat(l,'"')},isValidNewOption:function(l,c,p,d){return!(!l||c.some(function(a){return K(l,a,d)})||p.some(function(a){return K(l,a,d)}))},getNewOptionData:function(l,c){return{label:c,value:l,__isNew__:!0}}};function ue(n){var l=n.allowCreateWhileLoading,c=l===void 0?!1:l,p=n.createOptionPosition,d=p===void 0?"last":p,a=n.formatCreateLabel,x=a===void 0?R.formatCreateLabel:a,h=n.isValidNewOption,f=h===void 0?R.isValidNewOption:h,O=n.getNewOptionData,F=O===void 0?R.getNewOptionData:O,r=n.onCreateOption,b=n.options,g=b===void 0?[]:b,$=n.onChange,N=se(n,pe),E=N.getOptionValue,s=E===void 0?oe:E,L=N.getOptionLabel,M=L===void 0?ne:L,v=N.inputValue,j=N.isLoading,V=N.isMulti,C=N.value,k=N.name,w=D.useMemo(function(){return f(v,J(C),g,{getOptionValue:s,getOptionLabel:M})?F(v,x(v)):void 0},[x,F,M,s,v,f,g,C]),T=D.useMemo(function(){return(c||!j)&&w?d==="first"?[w].concat(z(g)):[].concat(z(g),[w]):g},[c,d,j,w,g]),I=D.useCallback(function(S,A){if(A.action!=="select-option")return $(S,A);var t=Array.isArray(S)?S:[S];if(t[t.length-1]===w){if(r)r(v);else{var o=F(v,v),i={action:"create-option",name:k,option:o};$(re(V,[].concat(z(J(C)),[o]),o),i)}return}$(S,A)},[F,v,V,k,w,r,$,C]);return G(G({},N),{},{options:T,onChange:I})}var he=D.forwardRef(function(n,l){var c=ie(n),p=ue(c);return D.createElement(le,ce({ref:l},p))}),be=he;function fe({value:n=[],onChange:l,placeholder:c=""}){const d=(Array.isArray(n)?n:[]).map(a=>({label:a,value:a}));return e.jsx(be,{isMulti:!0,placeholder:c,options:d,value:d,onChange:a=>{const x=a?a.map(h=>h.value):[];l(x)},className:"react-select-container",classNamePrefix:"react-select"})}function Ge({auth:n,session:l,title:c,subtitle:p,availableLocales:d,content_:a,titles:x,tags:h,excerpts:f,contents:O}){var I,S,A;const F=Object.fromEntries(d.flatMap(t=>{const o=(x==null?void 0:x[t])??"",i=(f==null?void 0:f[t])??"",m=(O==null?void 0:O[t])??"";let _=[];const u=h==null?void 0:h[t];if(Array.isArray(u))_=u;else if(typeof u=="string")try{_=JSON.parse(u)}catch{_=[],console.warn(`No pude parsear tags_${t} =`,u)}return[[`title_${t}`,o],[`tags_${t}`,_],[`excerpt_${t}`,i],[`content_${t}`,m]]})),{data:r,setData:b,errors:g,processing:$}=X({name:a.name||"",status:a.status,published_at:a.published_at||null,published_end:a.published_end||null,observations:a.observations||"",...F}),N=r.published_at?new Date(r.published_at):null,E=r.published_end?new Date(r.published_end):null,s=U(),L=((I=q())==null?void 0:I.props)||{},M=L.locale||!1,v=L.languages||[],j=L.permissions||{},V=((A=(S=L.languages)==null?void 0:S[M])==null?void 0:A[6])||"dd/MM/yyyy",C={};N&&(E?E<N&&(C.published_end="Fecha fin anterior a inicio"):C.published_end="Fecha fin obligatoria");const k=t=>{const{name:o,type:i,checked:m,value:_,files:u}=t.target;i==="checkbox"?b(o,m):i==="file"?b(o,u.length?u[0]:null):b(o,_)};de("contenido","contents.destroy",[a.id]);function w(t){if(t.preventDefault(),C.published_end)return;const o=new FormData;o.append("_method","PUT"),Object.entries(r).forEach(([i,m])=>{i==="logo"&&m instanceof File?o.append(i,m):m instanceof Date?o.append(i,m.toISOString()):m===null?o.append(i,""):typeof m=="object"?o.append(i,JSON.stringify(m)):o.append(i,m)}),Y.post(route("contents.update",a.id),o,{forceFormData:!0,preserveScroll:!0,onSuccess:()=>console.log("Contenido actualizado"),onError:i=>console.error("Errores:",i),onFinish:()=>console.log("PeticiÃ³n finalizada")})}const T=[];return j!=null&&j["contents.index"]&&T.push({text:s("contenidos_volver"),icon:"la-angle-left",url:"contents.index",modal:!1}),j!=null&&j["contents.create"]&&T.push({text:s("contenido_nuevo"),icon:"la-plus",url:"contents.create",modal:!1}),j!=null&&j["contents.destroy"]&&T.push({text:s("eliminar"),icon:"la-trash",method:"delete",url:"contents.destroy",params:[a.id],title:s("contenido_eliminar"),message:s("contenido_eliminar_confirm"),modal:!1}),e.jsxs(Z,{user:n.user,title:c,subtitle:p,actions:T,children:[e.jsx(Q,{title:c}),e.jsxs("div",{className:"contents pb-4",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-12",children:e.jsxs("h2",{children:[s("contenido")," ",e.jsx("u",{children:a.name})]})}),e.jsxs("div",{className:"col-12 mt-2 mb-4",children:[e.jsxs("span",{className:"text-muted me-5",children:[s("creado"),": ",e.jsx("strong",{children:a.formatted_created_at})]}),a.created_by_name&&e.jsxs("span",{className:"text-muted me-5",children:[s("creado_por"),": ",e.jsx("strong",{children:a.created_by_name})]}),e.jsxs("span",{className:"text-muted me-5",children:[s("actualizado"),": ",e.jsx("strong",{children:a.formatted_updated_at})]}),a.updated_by_name&&e.jsxs("span",{className:"text-muted me-5",children:[s("actualizado_por"),": ",e.jsx("strong",{children:a.updated_by_name})]})]})]}),e.jsxs("form",{onSubmit:w,children:[e.jsxs("div",{className:"row gy-3",children:[e.jsx("div",{className:"col-lg-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"code",className:"form-label",children:s("codigo")}),e.jsx(me,{code:a.code})]})}),e.jsx("div",{className:"col-lg-8",children:e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"name",className:"form-label",children:[s("nombre"),"*"]}),e.jsx(H,{className:"",type:"text",placeholder:s("contenido_nombre"),value:r.name,onChange:t=>b("name",t.target.value),maxLength:100}),e.jsx(P,{message:g.name})]})}),e.jsx("div",{className:"col-lg-4",children:e.jsxs("div",{className:"position-relative",children:[e.jsx("label",{htmlFor:"published_at",className:"form-label",children:s("fecha_publicacion")}),e.jsx(B,{id:"published_at",name:"published_at",selected:r.published_at?new Date(r.published_at):null,onChange:(t,o)=>{b(t,o),o||b("published_end",null)},dateFormat:V}),e.jsx(P,{message:g.published_at})]})}),e.jsx("div",{className:"col-lg-4",children:e.jsxs("div",{className:"position-relative",children:[e.jsx("label",{htmlFor:"published_end",className:"form-label",children:s("publicacion_fin")}),e.jsx(B,{id:"published_end",name:"published_end",selected:r.published_end?new Date(r.published_end):null,onChange:b,minDate:r.published_at?new Date(r.published_at):null,dateFormat:V}),e.jsx(P,{message:C.published_end||g.published_end})]})}),e.jsx("div",{className:"col-lg-2 text-center",children:e.jsxs("div",{className:"position-relative",children:[e.jsx("label",{htmlFor:"status",className:"form-label",children:s("contenido_activo")}),e.jsx("div",{className:"pt-1 position-relative",children:e.jsx(ee,{className:"xl",name:"status",checked:r.status,onChange:t=>b("status",t.target.checked)})})]})}),e.jsx("div",{className:"col-12 mt-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"observations",className:"form-label",children:s("observaciones")}),e.jsx(W,{id:"observations",name:"observations",value:r.observations,onChange:k,className:"form-control"}),e.jsx(P,{message:g.observations})]})}),e.jsx("div",{className:"col-12 mt-4",children:e.jsx(te,{availableLocales:d,languages:v,children:t=>{const o=Array.isArray(v[t])?v[t][3]:t,i=`title_${t}`,m=`tags_${t}`,_=`excerpt_${t}`,u=`content_${t}`;return e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-12 mb-3",children:[e.jsxs("label",{htmlFor:i,className:"form-label",children:[s("titulo")," ",o]}),e.jsx(H,{id:i,name:i,className:"",type:"text",value:r[i]||"",onChange:y=>b(i,y.target.value),onKeyDown:y=>y.key==="Enter"&&y.preventDefault(),maxLength:150})]}),e.jsxs("div",{className:"col-12 mb-3",children:[e.jsxs("label",{htmlFor:m,className:"form-label",children:[s("tags")," ",o]}),e.jsx(fe,{value:Array.isArray(r[m])?r[m]:[],onChange:y=>b(m,y)}),e.jsx(P,{message:g.tags_es})]}),e.jsxs("div",{className:"col-12 mb-3",children:[e.jsxs("label",{htmlFor:_,className:"form-label",children:[s("destacado")," ",o]}),e.jsx(W,{id:_,name:_,value:r[_]||"",onChange:k,className:"form-control"})]}),e.jsxs("div",{className:"col-12 mb-3",children:[e.jsxs("label",{htmlFor:u,className:"form-label",children:[s("contenido")," ",o]}),e.jsx(W,{id:u,name:u,value:r[u]??"",wysiwyg:!0,onChange:y=>b(u,y.target.value),className:""}),e.jsx(P,{message:g[u]})]})]},t)}})})]}),e.jsx("div",{className:"mt-4 text-end",children:e.jsx(ae,{disabled:$||!!C.published_end,className:"btn btn-rdn",children:$?s("procesando")+"...":s("guardar")})})]})]})]})}export{Ge as default};
