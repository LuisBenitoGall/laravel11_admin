import{r as n,j as e,A as L,X as O,G as K,S as P}from"./app-D2BBDCFC.js";import{A as q}from"./AdminAuthenticatedLayout-BpRIVWHk.js";import"./Header-BKPdAUPJ.js";import"./react-tooltip.min-Df6MMYhS.js";import"./ColorPicker-D4hNnjuS.js";import"./TextInput-WxNO9k3W.js";import"./SelectInput-xW4hb1gP.js";import{T as G}from"./Tabs-D4al1Fxl.js";import"./draftjs-to-html-BdN-nRo8.js";import"./useSweetAlert-D27GvFwx.js";import{u as A}from"./useTranslation-CVJluGRe.js";import{I as E}from"./InfoPopover-C7FUp5XC.js";import{R as X}from"./ModalTemplate-DNWm_Dg3.js";import{I as M}from"./InputError-BrT6sb3o.js";import $ from"./ModuleTab-BZGV31Zf.js";import B from"./FunctionalitiesTab-D1Vm8Oj4.js";import"./Sidebar-CyvRIWTq.js";import"./bootstrap.bundle.min-Ba_qfNiZ.js";import"./NavLink-DsoYfajC.js";import"./Dropdown-DDVnA8hG.js";import"./transition-DtKZpb_s.js";import"./OverlayTrigger-D8mD9LjI.js";import"./floating-ui.dom-CQJTMakY.js";import"./Checkbox-CbGRJxKs.js";import"./PrimaryButton-ML6K15LR.js";import"./Textarea-DElGcLax.js";import"./useTableManagement-CimlMvBQ.js";import"./es-CMu9_e4K.js";import"./TableExporter-D3yV3r2t.js";import"./FileSaver.min-Cyq3_crI.js";import"./typeof-QjJsDpFa.js";function H({show:h,onClose:b,onCreate:c,moduleId:j}){const t=A(),[a,u]=n.useState({name:"",label:""}),[d,p]=n.useState({}),[o,r]=n.useState(!1),s=l=>{const{name:i,value:v}=l.target;u(g=>{const f={...g,[i]:v};return console.log("form state:",f),f})},S=()=>{const l={};if(a.name||(l.name=t("campo_obligatorio")),a.label||(l.label=t("campo_obligatorio")),Object.keys(l).length>0){p(l);return}r(!0),L.post(route("functionalities.store"),{...a,module_id:j},{preserveScroll:!0,onSuccess:i=>{u({name:"",label:""}),p({}),b(),typeof c=="function"&&c()},onError:i=>{p(i)},onFinish:()=>r(!1)})};return e.jsxs(X,{show:h,onClose:b,onConfirm:S,title:t("funcionalidad_nueva"),confirmText:t(o?"guardando":"guardar"),cancelText:t("cancelar"),children:[e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"position-relative",children:[e.jsxs("label",{className:"form-label",children:[t("funcionalidad"),"*"]}),e.jsx("input",{type:"text",name:"name",className:"form-control",value:a.name,onChange:s,autoComplete:"off",maxLength:100}),e.jsx(E,{code:"functionality-name"}),e.jsx(M,{message:d.name})]})}),e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"position-relative",children:[e.jsxs("label",{className:"form-label",children:[t("etiqueta"),"*"]}),e.jsx("input",{type:"text",name:"label",className:"form-control",value:a.label,onChange:s,autoComplete:"off",maxLength:100}),e.jsx(E,{code:"functionality-label"}),e.jsx(M,{message:d.label})]})})]})}function Me({auth:h,session:b,title:c,subtitle:j,module_data:t,tab:a,levels:u,functionalities:d,availableLocales:p}){var T;const o=A(),r=((T=O())==null?void 0:T.props)||{};r.locale,r.languages;const s=r.permissions||{},[S,l]=n.useState(a||"module"),i=Object.entries(u||{}).map(([m,D])=>({value:m,label:D})),{data:v,setData:g,put:f,errors:w,processing:_}=K({name:t.name||"",level:t.level||"",label:t.label||"",icon:t.icon||"",color:t.color||"",status:t.status,explanation:t.explanation||""});function N(m){m.preventDefault(),f(route("modules.update",t.id),{preserveScroll:!0,onSuccess:()=>console.log("Movimiento actualizado")})}const[I,C]=n.useState(!1),[J,Q]=n.useState(!1),[U,V]=n.useState(null),k=()=>C(!0),z=()=>C(!1),[F,R]=n.useState(0),y=()=>R(m=>m+1),x=[];return s!=null&&s["modules.index"]&&x.push({text:o("modulos_volver"),icon:"la-angle-left",url:"modules.index",modal:!1}),s!=null&&s["modules.create"]&&x.push({text:o("modulo_nuevo"),icon:"la-plus",url:"modules.create",modal:!1}),s!=null&&s["modules.edit"]&&x.push({text:o("funcionalidad_nueva"),icon:"la-plus",url:"",modal:!0,onClick:k}),e.jsxs(q,{user:h.user,title:c,subtitle:j,actions:x,children:[e.jsx(P,{title:c}),e.jsxs("div",{className:"contents pb-4",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-12",children:e.jsxs("h2",{className:"d-flex align-items-center gap-2",children:[o("modulo"),t.icon&&e.jsx("i",{className:`la la-${t.icon} text-muted`,style:{fontSize:"1.2em"}}),e.jsx("u",{children:o(t.label)})]})}),e.jsxs("div",{className:"col-12 mt-2 mb-4",children:[e.jsxs("span",{className:"text-muted me-5",children:[o("creado"),": ",e.jsx("strong",{children:t.formatted_created_at})]}),t.created_by_name&&e.jsxs("span",{className:"text-muted me-5",children:[o("creado_por"),": ",e.jsx("strong",{children:t.created_by_name})]}),e.jsxs("span",{className:"text-muted me-5",children:[o("actualizado"),": ",e.jsx("strong",{children:t.formatted_updated_at})]}),t.updated_by_name&&e.jsxs("span",{className:"text-muted me-5",children:[o("actualizado_por"),": ",e.jsx("strong",{children:t.updated_by_name})]})]})]}),e.jsx(G,{tabs:[{key:"module",label:o("modulo"),content:e.jsx("form",{onSubmit:N,children:e.jsx($,{data:v,setData:g,errors:w,levelsArray:i,processing:_,handleSubmit:N})})},{key:"functionalities",label:o("funcionalidades"),content:e.jsx(B,{module_data:t,functionalities:d,onCreated:y,onDeleted:y,refreshKey:F},F)}],defaultActive:a}),e.jsx(H,{show:I,onClose:z,onCreate:y,moduleId:t.id})]})]})}export{Me as default};
