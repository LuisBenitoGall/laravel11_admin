import{j as e,r as l,A as O,X as R,G as K,S as P}from"./app-Vy3k0dXk.js";import{A as q}from"./AdminAuthenticatedLayout-RXgeCdrB.js";import"./Header-CzP3bCHI.js";import"./react-tooltip.min-C0giFYtK.js";import"./ColorPicker-CrLRK-qs.js";import"./TextInput-B6FzyUMY.js";import"./SelectInput-C5X4bp1Q.js";import{T as G}from"./Tabs-DyDSKHhW.js";import"./draftjs-to-html-rXm3VHoF.js";import"./useSweetAlert-McVN4vy-.js";import{u as k}from"./useTranslation-bNzddkut.js";import{I as E}from"./InfoPopover-DZRJR7k7.js";import{I as M}from"./InputError-DMNw4oH7.js";import X from"./ModuleTab-DncfJB-S.js";import $ from"./FunctionalitiesTab-DsD14i2z.js";import"./Sidebar-CCn1nLaa.js";import"./bootstrap.bundle.min-B2fMu5hW.js";import"./NavLink-1EYN7PL6.js";import"./Dropdown-C05IHB0O.js";import"./transition-CGU5FYrv.js";import"./OverlayTrigger-DvJH8nk_.js";import"./floating-ui.dom-CQJTMakY.js";import"./Checkbox-szYglKdk.js";import"./PrimaryButton-DRjProiT.js";import"./Textarea-7Q1X7LaW.js";import"./useTableManagement-BQ5yzFRQ.js";import"./es-290DBA3j.js";import"./TableExporter-DYGiwVVL.js";import"./typeof-QjJsDpFa.js";const B=({show:u,onClose:r,title:n,children:p,onConfirm:t,confirmText:o="Confirmar",cancelText:c="Cancelar"})=>e.jsx(e.Fragment,{children:u&&e.jsx("div",{className:"modal fade show",style:{display:"block"},tabIndex:"-1",role:"dialog","aria-labelledby":"modalTitle","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",id:"modalTitle",children:n}),e.jsx("button",{type:"button",className:"close ms-auto",onClick:r,"aria-label":"Close",children:e.jsx("span",{"aria-hidden":"true",children:"Ã—"})})]}),e.jsx("div",{className:"modal-body",children:p}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:r,children:c}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:t,children:o})]})]})})})});function H({show:u,onClose:r,onCreate:n,moduleId:p}){const t=k(),[o,c]=l.useState({name:"",label:""}),[f,h]=l.useState({}),[s,m]=l.useState(!1),a=i=>{const{name:d,value:v}=i.target;c(y=>{const b={...y,[d]:v};return console.log("form state:",b),b})},N=()=>{const i={};if(o.name||(i.name=t("campo_obligatorio")),o.label||(i.label=t("campo_obligatorio")),Object.keys(i).length>0){h(i);return}m(!0),O.post(route("functionalities.store"),{...o,module_id:p},{preserveScroll:!0,onSuccess:d=>{c({name:"",label:""}),h({}),r(),typeof n=="function"&&n()},onError:d=>{h(d)},onFinish:()=>m(!1)})};return e.jsxs(B,{show:u,onClose:r,onConfirm:N,title:t("funcionalidad_nueva"),confirmText:t("guardar"),cancelText:t("cancelar"),children:[e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"position-relative",children:[e.jsxs("label",{className:"form-label",children:[t("funcionalidad"),"*"]}),e.jsx("input",{type:"text",name:"name",className:"form-control",value:o.name,onChange:a,autoComplete:"off",maxLength:100}),e.jsx(E,{code:"functionality-name"}),e.jsx(M,{message:f.name})]})}),e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"position-relative",children:[e.jsxs("label",{className:"form-label",children:[t("etiqueta"),"*"]}),e.jsx("input",{type:"text",name:"label",className:"form-control",value:o.label,onChange:a,autoComplete:"off",maxLength:100}),e.jsx(E,{code:"functionality-label"}),e.jsx(M,{message:f.label})]})})]})}function Fe({auth:u,session:r,title:n,subtitle:p,module_data:t,tab:o,levels:c,functionalities:f,availableLocales:h}){var F;const s=k(),m=((F=R())==null?void 0:F.props)||{};m.locale,m.languages;const a=m.permissions||{},[N,i]=l.useState(o||"module"),d=Object.entries(c||{}).map(([x,L])=>({value:x,label:L})),{data:v,setData:y,put:b,errors:w,processing:A}=K({name:t.name||"",level:t.level||"",label:t.label||"",icon:t.icon||"",color:t.color||"",status:t.status,explanation:t.explanation||""});function C(x){x.preventDefault(),b(route("modules.update",t.id),{preserveScroll:!0,onSuccess:()=>console.log("Movimiento actualizado")})}const[I,S]=l.useState(!1),[J,Q]=l.useState(!1),[U,V]=l.useState(null),_=()=>S(!0),z=()=>S(!1),[T,D]=l.useState(0),g=()=>D(x=>x+1),j=[];return a!=null&&a["modules.index"]&&j.push({text:s("modulos_volver"),icon:"la-angle-left",url:"modules.index",modal:!1}),a!=null&&a["modules.create"]&&j.push({text:s("modulo_nuevo"),icon:"la-plus",url:"modules.create",modal:!1}),a!=null&&a["modules.edit"]&&j.push({text:s("funcionalidad_nueva"),icon:"la-plus",url:"",modal:!0,onClick:_}),e.jsxs(q,{user:u.user,title:n,subtitle:p,actions:j,children:[e.jsx(P,{title:n}),e.jsxs("div",{className:"contents pb-4",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-12",children:e.jsxs("h2",{className:"d-flex align-items-center gap-2",children:[s("modulo"),t.icon&&e.jsx("i",{className:`la la-${t.icon} text-muted`,style:{fontSize:"1.2em"}}),e.jsx("u",{children:s(t.label)})]})}),e.jsxs("div",{className:"col-12 mt-2 mb-4",children:[e.jsxs("span",{className:"text-muted me-5",children:[s("creado"),": ",e.jsx("strong",{children:t.formatted_created_at})]}),t.created_by_name&&e.jsxs("span",{className:"text-muted me-5",children:[s("creado_por"),": ",e.jsx("strong",{children:t.created_by_name})]}),e.jsxs("span",{className:"text-muted me-5",children:[s("actualizado"),": ",e.jsx("strong",{children:t.formatted_updated_at})]}),t.updated_by_name&&e.jsxs("span",{className:"text-muted me-5",children:[s("actualizado_por"),": ",e.jsx("strong",{children:t.updated_by_name})]})]})]}),e.jsx(G,{tabs:[{key:"module",label:s("modulo"),content:e.jsx("form",{onSubmit:C,children:e.jsx(X,{data:v,setData:y,errors:w,levelsArray:d,processing:A,handleSubmit:C})})},{key:"functionalities",label:s("funcionalidades"),content:e.jsx($,{module_data:t,functionalities:f,onCreated:g,onDeleted:g,refreshKey:T},T)}],defaultActive:o}),e.jsx(H,{show:I,onClose:z,onCreate:g,moduleId:t.id})]})]})}export{Fe as default};
