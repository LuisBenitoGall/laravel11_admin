import{G as _,j as e,X as C,S}from"./app-DRj95fl3.js";import{A as w}from"./AdminAuthenticatedLayout-Bvk28IJ_.js";import{C as v}from"./Checkbox-pg3dOide.js";import{I as j}from"./InputError-DR469WsC.js";import{T as N}from"./TextInput-DHZ4LhQ-.js";import{P as k}from"./PrimaryButton-CT79ceK8.js";import{u as y}from"./useTranslation-BmHTxgDU.js";import"./Header-sOAC_5kI.js";import"./useSweetAlert-D-bXTlQV.js";import"./OverlayTrigger-BXbmHDr2.js";import"./Sidebar-Cs0Qbv6j.js";import"./bootstrap.bundle.min-CIHLONa7.js";import"./NavLink-B2TCDQIx.js";import"./Dropdown-CxSOcthg.js";import"./transition-MDSzoOOX.js";function F({action:u,initial:o={}}){const a=y(),{data:t,setData:r,post:x,processing:m,errors:i}=_({name:o.name||"",ndigits:o.ndigits||1,status:o.status??!0,yearly_reset:o.yearly_reset??!1,segments:o.segments||[{type:"digits"}]}),d=t.segments.some(s=>s.type==="digits"),p=()=>{r("segments",[...t.segments,{type:d?"text":"digits",value:""}])},b=s=>{const l=t.segments.filter((n,g)=>g!==s);r("segments",l)},h=(s,l)=>{if(l.type==="digits"&&d&&t.segments[s].type!=="digits")return;const n=t.segments.map((g,c)=>c===s?{...g,...l}:g);r("segments",n)},f=s=>{s.preventDefault(),t.segments.some(l=>l.type==="digits")&&x(u)},Y=()=>{const s=new Date,l=s.getFullYear().toString().slice(-2),n=s.getFullYear().toString(),g=String(1).padStart(t.ndigits||1,"0");return(t.segments||[]).map(c=>c.type==="digits"?g:c.type==="text"?c.value||"":c.type==="year"?(c.value||"YYYY")==="YY"?l:n:"").join("")};return e.jsxs("form",{onSubmit:f,autoComplete:"off",children:[e.jsxs("div",{className:"row gy-3 mb-4",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"position-relative",children:[e.jsxs("label",{htmlFor:"name",className:"form-label",children:[a("patron_nombre")," *"]}),e.jsx(N,{type:"text",name:"name",value:t.name,onChange:s=>r("name",s.target.value),maxLength:150,required:!0}),e.jsx(j,{message:i.name})]})}),e.jsx("div",{className:"col-2",children:e.jsxs("div",{className:"position-relative",children:[e.jsxs("label",{htmlFor:"ndigits",className:"form-label",children:[a("digitos_num"),"*"]}),e.jsx(N,{type:"number",name:"ndigits",value:t.ndigits,onChange:s=>r("ndigits",s.target.value),maxLength:150,required:!0}),e.jsx(j,{message:i.ndigits})]})}),e.jsx("div",{className:"col-lg-1 text-center",children:e.jsxs("div",{className:"position-relative",children:[e.jsx("label",{htmlFor:"status",className:"form-label",children:a("estado")}),e.jsx("div",{className:"pt-1 position-relative",children:e.jsx(v,{className:"xl",name:"status",checked:t.status,onChange:s=>r("status",s.target.checked)})})]})}),o.yearly_reset===!0&&e.jsx("div",{className:"col-lg-2 text-center",children:e.jsxs("div",{className:"position-relative",children:[e.jsx("label",{htmlFor:"yearly_reset",className:"form-label",children:a("reset_anual")}),e.jsx("div",{className:"pt-1 position-relative",children:e.jsx(v,{className:"xl",name:"yearly_reset",checked:t.yearly_reset,onChange:s=>r("yearly_reset",s.target.checked)})})]})})]}),e.jsxs("div",{className:"row gy-3 mb-4",children:[e.jsx("label",{className:"col-lg-2 col-form-label",children:a("segmento_add")}),e.jsx("div",{className:"col-lg-1 pt-1",children:e.jsx("button",{type:"button",className:"btn btn-warning btn-circle text-white",onClick:p,disabled:d&&t.segments.filter(s=>s.type==="digits").length>0,children:e.jsx("i",{className:"la la-plus"})})}),e.jsx("label",{className:"col-lg-8 col-form-label text-warning",children:e.jsx("span",{dangerouslySetInnerHTML:{__html:a("segmento_add_info")}})})]}),e.jsxs("div",{className:"gy-3 mb-3",children:[e.jsxs("div",{className:"row",children:[e.jsx("label",{className:"col-lg-2 col-form-label",children:a("segmentos")}),e.jsxs("div",{className:"col-md-8",children:[i.segments&&e.jsx("div",{className:"text-danger mb-2",children:i.segments}),!t.segments.some(s=>s.type==="digits")&&e.jsx("div",{className:"pb-1",children:e.jsx("small",{className:"text-danger",children:a("patron_digitos_aviso")})}),t.segments.map((s,l)=>e.jsxs("div",{className:"row g-2 align-items-start mb-2",children:[e.jsx("div",{className:"col-6",children:e.jsxs("select",{className:"form-select",value:s.type,onChange:n=>h(l,{type:n.target.value,value:void 0}),children:[e.jsx("option",{value:"digits",children:"Dígitos"}),e.jsx("option",{value:"text",children:"Texto"}),e.jsx("option",{value:"year",children:"Año"})]})}),e.jsxs("div",{className:"col-5",children:[s.type==="text"&&e.jsx("input",{className:"form-control",value:s.value||"",onChange:n=>h(l,{value:n.target.value})}),s.type==="year"&&e.jsxs("select",{className:"form-select",value:s.value||"YYYY",onChange:n=>h(l,{value:n.target.value}),children:[e.jsx("option",{value:"YYYY",children:"YYYY"}),e.jsx("option",{value:"YY",children:"YY"})]}),s.type==="digits"&&e.jsx("input",{className:"form-control",value:"#".repeat(Math.min(10,t.ndigits)),disabled:!0})]}),e.jsx("div",{className:"col-1 d-flex justify-content-start pt-1",children:l>0&&e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>b(l),title:a("segmento_eliminar"),children:e.jsx("i",{className:"la la-times"})})})]},l))]})]}),e.jsxs("div",{className:"row mt-4",children:[e.jsx("label",{className:"col-lg-2 col-form-label",children:a("vista_previa")}),e.jsx("div",{className:"col-md-5 text-center",children:e.jsx("code",{className:"pattern-code",children:Y()})})]}),e.jsx("div",{className:"mt-4 text-end",children:e.jsx(k,{disabled:m||!t.segments.some(s=>s.type==="digits"),className:"btn btn-rdn",children:m?a("procesando")+"...":a("guardar")})})]})]})}function J({auth:u,session:o,title:a,subtitle:t,availableLocales:r}){var p;const x=y(),m=((p=C())==null?void 0:p.props)||{};m.locale,m.languages;const i=m.permissions||{},d=[];return i!=null&&i["product-patterns.index"]&&d.push({text:x("patrones_volver"),icon:"la-angle-left",url:"product-patterns.index",modal:!1}),e.jsxs(w,{user:u.user,title:a,subtitle:t,actions:d,children:[e.jsx(S,{title:a}),e.jsx("div",{className:"contents pb-4",children:e.jsx(F,{action:route("product-patterns.store")})})]})}export{J as default};
