import{X as w,G as A,r as j,j as e,S as U}from"./app-NnFxdXA2.js";import{A as k}from"./AdminAuthenticatedLayout-DegxA_vr.js";import"./Header-CD84b1cW.js";import"./react-tooltip.min-D40t4uH0.js";import{T as I}from"./Tabs-C86ks92B.js";import{T as y}from"./TextInput-CyElN-IW.js";import{u as E}from"./useSweetAlert-9_SeR-8m.js";import{u as M}from"./useTranslation-D4BTlT_h.js";import{R as q}from"./ModalTemplate-CDslD_S0.js";import{I as u}from"./InputError-BTDowRim.js";import{F as D}from"./DatePickerToForm-CcYFgCTJ.js";import F from"./CompanyInfoTab-flE8O879.js";import O from"./CompanyUsersTab-ZGVTEXYT.js";import"./Sidebar-Drm6TH6A.js";import"./bootstrap.bundle.min-BWQMyn1D.js";import"./NavLink-lbotXNTD.js";import"./Dropdown-CmfadxWU.js";import"./transition-CHBtRj2X.js";import"./OverlayTrigger-Cq1xmpeu.js";import"./floating-ui.dom-CQJTMakY.js";import"./es-CcTx2m4K.js";/* empty css                         */import"./FileInput-tFjlObSd.js";import"./InfoPopover-CZOB6J_o.js";import"./PrimaryButton-T50Lbu5Y.js";import"./useTableManagement-Ba3jHw9z.js";import"./SelectInput-Dgf13zl3.js";import"./TableExporter-B-AMcDr1.js";import"./typeof-QjJsDpFa.js";import"./StatusButton-CF0JIfNg.js";import"./renderCellContent-CfgmT6uf.js";function K({show:v,onClose:p,onCreate:h,companyId:x,side:i}){var N;const t=M(),_=(((N=w())==null?void 0:N.props)||{}).roles||{};Object.entries(_).map(([s,a])=>({value:s,label:a}));const{data:l,setData:o,post:n,processing:f,reset:r,errors:c,clearErrors:S}=A({role:"",name:"",surname:"",email:"",status:!0,link_company:!0,send_pwd:!1,birthday:null,position:"",phones:[""],company_id:x||null,side:i||""});j.useEffect(()=>{o("company_id",x||null),S()},[v,x]);const C=()=>{o("phones",[...l.phones||[],""])},b=(s,a)=>{const m=[...l.phones||[]];m[s]=a,o("phones",m)},R=s=>{const a=[...l.phones||[]];a.splice(s,1),o("phones",a.length?a:[""])},d=j.useRef(null),g=()=>{d.current&&typeof d.current.reportValidity=="function"&&!d.current.reportValidity()||n(route("users.store"),{preserveScroll:!0,onSuccess:s=>{r(),p==null||p(),typeof h=="function"&&h(s)}})};return e.jsx(q,{show:v,onClose:p,onConfirm:g,title:t("usuario_nuevo"),confirmText:t(f?"guardando":"guardar"),cancelText:t("cancelar"),children:e.jsxs("form",{ref:d,onSubmit:s=>{s.preventDefault(),g()},children:[e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"position-relative",children:[e.jsxs("label",{className:"form-label",children:[t("nombre"),"*"]}),e.jsx(y,{value:l.name,onChange:s=>o("name",s.target.value),required:!0}),e.jsx(u,{message:c.name})]})}),e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"position-relative",children:[e.jsxs("label",{className:"form-label",children:[t("apellidos"),"*"]}),e.jsx(y,{value:l.surname,onChange:s=>o("surname",s.target.value),required:!0}),e.jsx(u,{message:c.surname})]})}),e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"position-relative",children:[e.jsxs("label",{className:"form-label",children:[t("email"),"*"]}),e.jsx(y,{type:"email",value:l.email,onChange:s=>o("email",s.target.value),required:!0}),e.jsx(u,{message:c.email})]})}),e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"position-relative",children:[e.jsx("label",{className:"form-label",children:t("cargo")}),e.jsx(y,{value:l.position,onChange:s=>o("position",s.target.value)}),e.jsx(u,{message:c.position})]})}),e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"position-relative",children:[e.jsx(D,{name:"birthday",selected:l.birthday?new Date(l.birthday):null,onChange:(s,a)=>o(s,a?a.toISOString().split("T")[0]:null),dateFormat:"dd/MM/yyyy",label:"fecha_nacimiento",required:!1}),e.jsx(u,{message:c.birthday})]})}),e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"position-relative",children:[e.jsx("label",{className:"form-label",children:t("telefonos")}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-9",children:[(l.phones||[]).map((s,a)=>e.jsxs("div",{className:"input-group mb-3",children:[e.jsx("input",{type:"text",className:"form-control",value:s,onChange:m=>b(a,m.target.value),maxLength:14}),e.jsx("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>R(a),children:e.jsx("i",{className:"la la-trash"})})]},`phone-${a}`)),e.jsx(u,{message:c.phones})]}),e.jsx("div",{className:"col-md-3",children:e.jsxs("button",{type:"button",className:"btn btn-sm btn-secondary mt-2",onClick:C,children:[e.jsx("i",{className:"la la-plus"})," ",t("telefono")||"Añadir teléfono"]})})]})]})})]})})}function ve({auth:v,session:p,title:h,subtitle:x,customer:i,relation:t,users:T,rows:_,tab:l,availableLocales:o}){var m;const n=M(),f=((m=w())==null?void 0:m.props)||{};f.locale,f.languages,E();const r=f.permissions||{},[c,S]=j.useState(l||"info");A({name:i.name||"",status:t.status});const[C,b]=j.useState(!1),[R,d]=j.useState(0),g=()=>b(!0),N=()=>b(!1),s=()=>d(P=>P+1),a=[];return r!=null&&r["customers.index"]&&a.push({text:n("clientes_volver"),icon:"la-angle-left",url:"customers.index",modal:!1}),r!=null&&r["customers.create"]&&a.push({text:n("cliente_nuevo"),icon:"la-plus",url:"customers.create",modal:!1}),r!=null&&r["users.create"]&&a.push({text:n("usuario_nuevo"),icon:"la-plus",url:"",modal:!0,onClick:g}),r!=null&&r["customers.destroy"]&&a.push({text:n("eliminar"),icon:"la-trash",method:"delete",url:"customers.destroy",params:[t.id],title:n("cliente_eliminar"),message:n("cliente_eliminar_confirm"),modal:!1}),e.jsxs(k,{user:v.user,title:h,subtitle:x,actions:a,children:[e.jsx(U,{title:h}),e.jsxs("div",{className:"contents pb-4",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-12",children:e.jsxs("h2",{children:[n("cliente")," ",e.jsx("u",{children:i.name})]})}),e.jsxs("div",{className:"col-12 mt-2 mb-4",children:[e.jsxs("span",{className:"text-muted me-5",children:[n("creado"),": ",e.jsx("strong",{children:t.formatted_created_at})]}),e.jsxs("span",{className:"text-muted",children:[n("actualizado"),": ",e.jsx("strong",{children:t.formatted_updated_at})]})]})]}),e.jsx(I,{tabs:[{key:"info",label:n("informacion_general"),content:e.jsx(F,{company:i,side:"customers",updateRoute:"companies.update",updateParams:[i.id]})},{key:"users",label:n("usuarios"),content:e.jsx(O,{users:T??null,rows:_??[],indexRoute:"customers.edit",indexParams:i.id,tableId:"tblCompanyUsers"})}],defaultActive:l}),e.jsx(K,{show:C,onClose:N,onCreate:s,companyId:i.id,side:"customers"})]})]})}export{ve as default};
