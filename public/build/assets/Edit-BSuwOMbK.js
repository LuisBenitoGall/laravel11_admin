import{r as n,j as e,A as L,X as O,G as K,S as P}from"./app-ipN4Lpei.js";import{A as q}from"./AdminAuthenticatedLayout-Dnf9viHk.js";import"./Header-bG4uIAmT.js";import"./react-tooltip.min-Cg_Z_WJL.js";import"./ColorPicker-D8p3dLpQ.js";import"./TextInput-CkCvusrN.js";import"./SelectInput-D0rCu0qC.js";import{T as G}from"./Tabs-B0yDq7mB.js";import"./draftjs-to-html-ByXe0Pce.js";import"./useSweetAlert-CmWHaLPS.js";import{u as A}from"./useTranslation-C25qZZp5.js";import{I as E}from"./InfoPopover-BQJ1IiiV.js";import{R as X}from"./ModalTemplate-sNcpIzGK.js";import{I as M}from"./InputError-BRgDUzXy.js";import $ from"./ModuleTab-CgUVsdzJ.js";import B from"./FunctionalitiesTab-z2c2VqA-.js";import"./Sidebar-Dzqm1Vbq.js";import"./bootstrap.bundle.min-C7oov5VN.js";import"./NavLink-BFjf2yvp.js";import"./Dropdown-DaycTqil.js";import"./transition-B_klRBgP.js";import"./OverlayTrigger-p_uRoGhW.js";import"./floating-ui.dom-CQJTMakY.js";import"./Checkbox-C1MJcpfW.js";import"./PrimaryButton-BZCXfhHb.js";import"./Textarea-My1RaWQC.js";import"./useTableManagement-ok2MqPin.js";import"./es-dSXlHLzL.js";import"./TableExporter-DGl194Wv.js";import"./typeof-QjJsDpFa.js";function H({show:h,onClose:b,onCreate:c,moduleId:j}){const t=A(),[a,u]=n.useState({name:"",label:""}),[d,p]=n.useState({}),[s,r]=n.useState(!1),o=l=>{const{name:i,value:v}=l.target;u(g=>{const f={...g,[i]:v};return console.log("form state:",f),f})},S=()=>{const l={};if(a.name||(l.name=t("campo_obligatorio")),a.label||(l.label=t("campo_obligatorio")),Object.keys(l).length>0){p(l);return}r(!0),L.post(route("functionalities.store"),{...a,module_id:j},{preserveScroll:!0,onSuccess:i=>{u({name:"",label:""}),p({}),b(),typeof c=="function"&&c()},onError:i=>{p(i)},onFinish:()=>r(!1)})};return e.jsxs(X,{show:h,onClose:b,onConfirm:S,title:t("funcionalidad_nueva"),confirmText:t("guardar"),cancelText:t("cancelar"),children:[e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"position-relative",children:[e.jsxs("label",{className:"form-label",children:[t("funcionalidad"),"*"]}),e.jsx("input",{type:"text",name:"name",className:"form-control",value:a.name,onChange:o,autoComplete:"off",maxLength:100}),e.jsx(E,{code:"functionality-name"}),e.jsx(M,{message:d.name})]})}),e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"position-relative",children:[e.jsxs("label",{className:"form-label",children:[t("etiqueta"),"*"]}),e.jsx("input",{type:"text",name:"label",className:"form-control",value:a.label,onChange:o,autoComplete:"off",maxLength:100}),e.jsx(E,{code:"functionality-label"}),e.jsx(M,{message:d.label})]})})]})}function Ee({auth:h,session:b,title:c,subtitle:j,module_data:t,tab:a,levels:u,functionalities:d,availableLocales:p}){var T;const s=A(),r=((T=O())==null?void 0:T.props)||{};r.locale,r.languages;const o=r.permissions||{},[S,l]=n.useState(a||"module"),i=Object.entries(u||{}).map(([m,D])=>({value:m,label:D})),{data:v,setData:g,put:f,errors:w,processing:_}=K({name:t.name||"",level:t.level||"",label:t.label||"",icon:t.icon||"",color:t.color||"",status:t.status,explanation:t.explanation||""});function N(m){m.preventDefault(),f(route("modules.update",t.id),{preserveScroll:!0,onSuccess:()=>console.log("Movimiento actualizado")})}const[I,C]=n.useState(!1),[J,Q]=n.useState(!1),[U,V]=n.useState(null),k=()=>C(!0),z=()=>C(!1),[F,R]=n.useState(0),y=()=>R(m=>m+1),x=[];return o!=null&&o["modules.index"]&&x.push({text:s("modulos_volver"),icon:"la-angle-left",url:"modules.index",modal:!1}),o!=null&&o["modules.create"]&&x.push({text:s("modulo_nuevo"),icon:"la-plus",url:"modules.create",modal:!1}),o!=null&&o["modules.edit"]&&x.push({text:s("funcionalidad_nueva"),icon:"la-plus",url:"",modal:!0,onClick:k}),e.jsxs(q,{user:h.user,title:c,subtitle:j,actions:x,children:[e.jsx(P,{title:c}),e.jsxs("div",{className:"contents pb-4",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-12",children:e.jsxs("h2",{className:"d-flex align-items-center gap-2",children:[s("modulo"),t.icon&&e.jsx("i",{className:`la la-${t.icon} text-muted`,style:{fontSize:"1.2em"}}),e.jsx("u",{children:s(t.label)})]})}),e.jsxs("div",{className:"col-12 mt-2 mb-4",children:[e.jsxs("span",{className:"text-muted me-5",children:[s("creado"),": ",e.jsx("strong",{children:t.formatted_created_at})]}),t.created_by_name&&e.jsxs("span",{className:"text-muted me-5",children:[s("creado_por"),": ",e.jsx("strong",{children:t.created_by_name})]}),e.jsxs("span",{className:"text-muted me-5",children:[s("actualizado"),": ",e.jsx("strong",{children:t.formatted_updated_at})]}),t.updated_by_name&&e.jsxs("span",{className:"text-muted me-5",children:[s("actualizado_por"),": ",e.jsx("strong",{children:t.updated_by_name})]})]})]}),e.jsx(G,{tabs:[{key:"module",label:s("modulo"),content:e.jsx("form",{onSubmit:N,children:e.jsx($,{data:v,setData:g,errors:w,levelsArray:i,processing:_,handleSubmit:N})})},{key:"functionalities",label:s("funcionalidades"),content:e.jsx(B,{module_data:t,functionalities:d,onCreated:y,onDeleted:y,refreshKey:F},F)}],defaultActive:a}),e.jsx(H,{show:I,onClose:z,onCreate:y,moduleId:t.id})]})]})}export{Ee as default};
