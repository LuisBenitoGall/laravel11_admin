import{j as l}from"./app-DRj95fl3.js";import{E as A,F as k,a as _,b as j}from"./FileSaver.min-Bs0fFUdx.js";import{u as T}from"./useTranslation-BmHTxgDU.js";const C=({fetchData:p,columns:s,filename:x="export"})=>{const c=T(),w=c("datos"),y=c("error_export_excel"),f=c("error_export_pdf"),m=e=>{if(typeof e!="string")return e;const r=document.createElement("div");return r.innerHTML=e,r.textContent||r.innerText||""},h=async()=>{try{let e=await p();if(console.log("TableExporter fetchData result:",e),!Array.isArray(e))if(e&&Array.isArray(e.data))e=e.data;else if(e&&typeof e=="object"){const t=Object.keys(e).find(d=>Array.isArray(e[d]));if(t)e=e[t];else throw new Error("Los datos exportados no son un array.")}else throw new Error("Los datos exportados no son un array.");const r=new A.Workbook,n=r.addWorksheet(w),i=s.map(t=>t.label);n.addRow(i),e.forEach(t=>{const d=s.map(b=>{const u=t[b.key];return b.export==="html"?m(u):u});n.addRow(d)});const o=await r.xlsx.writeBuffer(),a=new Blob([o],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});k.saveAs(a,`${x}.xlsx`)}catch(e){alert(y+" "+((e==null?void 0:e.message)||"")),console.error(y,e)}},E=async()=>{try{let e=await p();if(console.log("TableExporter fetchData result:",e),!Array.isArray(e))if(e&&Array.isArray(e.data))e=e.data;else if(e&&typeof e=="object"){const o=Object.keys(e).find(a=>Array.isArray(e[a]));if(o)e=e[o];else throw new Error("Los datos exportados no son un array.")}else throw new Error("Los datos exportados no son un array.");const r=new _,n=s.map(o=>o.label),i=e.map(o=>s.map(a=>{const t=o[a.key];return a.export==="html"?m(t):t}));j(r,{head:[n],body:i,styles:{fontSize:8},headStyles:{fillColor:[91,201,214]}}),r.save(`${x}.pdf`)}catch(e){alert(f+" "+((e==null?void 0:e.message)||"")),console.error(f,e)}};return l.jsx("div",{className:"d-flex align-items-center ms-4",children:l.jsxs("div",{className:"ms-auto d-flex gap-2",children:[l.jsx("button",{onClick:h,className:"btn btn-primary btn-rdn",children:"Excel"}),l.jsx("button",{onClick:E,className:"btn btn-primary btn-rdn",children:"PDF"})]})})};export{C as T};
