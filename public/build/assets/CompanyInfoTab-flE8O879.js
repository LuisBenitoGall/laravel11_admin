import{G as E,r as x,j as e,A as h}from"./app-NnFxdXA2.js";import{F as I}from"./FileInput-tFjlObSd.js";import{I as w}from"./InfoPopover-CZOB6J_o.js";import{I as f}from"./InputError-BTDowRim.js";import{P as D}from"./PrimaryButton-T50Lbu5Y.js";import{T as u}from"./TextInput-CyElN-IW.js";import{u as L}from"./useTranslation-D4BTlT_h.js";import{u as P}from"./useSweetAlert-9_SeR-8m.js";import"./OverlayTrigger-Cq1xmpeu.js";function T({company:a={},side:c=!1,updateRoute:g="companies.update",updateParams:d=null}){const t=L(),{showConfirm:j}=P();d??(a==null||a.id);const{data:i,setData:o,errors:m,processing:p}=E({name:a.name??"",tradename:a.tradename??"",nif:a.nif??"",side:c||"",logo:null});x.useEffect(()=>{o("name",a.name??""),o("tradename",a.tradename??""),o("nif",a.nif??"")},[a]);const[W,b]=x.useState(!a.logo&&!a.logo_url),N=r=>{const{name:s,type:l,checked:n,value:C,files:F}=r.target;l==="checkbox"?o(s,n):l==="file"?o(s,F[0]):o(s,C)};async function _(r){r.preventDefault();const s=new FormData;s.append("_method","PUT"),Object.entries(i).forEach(([l,n])=>{l==="logo"&&n instanceof File?s.append(l,n):typeof n=="object"&&n!==null?s.append(l,JSON.stringify(n)):n!==null&&typeof n<"u"&&s.append(l,n)}),h.post(route("companies.update",a.id),s,{forceFormData:!0,preserveScroll:!0,onSuccess:()=>console.log("Empresa actualizada"),onError:l=>console.error("Errores:",l),onFinish:()=>console.log("PeticiÃ³n finalizada")})}const v=()=>{j({title:t("logo_eliminar"),text:t("logo_eliminar_confirm"),icon:"warning",onConfirm:()=>{h.delete(route("companies.logo.delete",a.id),{preserveScroll:!0,onSuccess:()=>{b(!0)}})}})},S=r=>{if(typeof r!="string")return"";const s=r.trim();return s?s.startsWith("http")||s.startsWith("//")||s.startsWith("/")?s:s.includes("storage/")?"/"+s.replace(/^\/+/,""):s.includes("companies/")?"/storage/"+s.replace(/^\/+/,""):`/storage/companies/${s.replace(/^\/+/,"")}`:""};return e.jsx("form",{onSubmit:_,children:e.jsxs("div",{className:"row gy-3",children:[e.jsxs("div",{className:"col-lg-6",children:[e.jsxs("label",{className:"form-label",children:[t("razon_social"),"*"]}),e.jsx(u,{type:"text",placeholder:t("empresa_nombre"),value:i.name,onChange:r=>o("name",r.target.value),maxLength:100,required:!0}),e.jsx(f,{message:m.name})]}),e.jsxs("div",{className:"col-lg-6",children:[e.jsxs("label",{className:"form-label",children:[t("nombre_comercial"),"*"]}),e.jsx(u,{type:"text",placeholder:t("nombre_comercial"),value:i.tradename,onChange:r=>o("tradename",r.target.value),maxLength:100,required:!0}),e.jsx(f,{message:m.tradename})]}),e.jsxs("div",{className:"col-lg-3",children:[e.jsxs("label",{className:"form-label",children:[t("nif"),"*"]}),e.jsx(u,{type:"text",placeholder:t("nif"),value:i.nif,onChange:r=>o("nif",r.target.value),maxLength:15,required:!0}),e.jsx(w,{code:"company-nif"}),e.jsx(f,{message:m.nif})]}),e.jsxs("div",{className:"offset-lg-1 col-lg-8",children:[e.jsx("label",{className:"form-label",children:t("logo")}),a.logo?e.jsxs("div",{className:"d-flex align-items-start",children:[e.jsx("img",{src:a.logo_url??S(a.logo),alt:a.name,className:"img-thumbnail me-3",style:{maxWidth:"300px",objectFit:"contain"}}),e.jsx("button",{type:"button",className:"ms-2 btn btn-sm btn-danger",onClick:v,children:e.jsx("i",{className:"la la-trash"})})]}):e.jsx(I,{name:"logo",accept:"image/*",onChange:N,error:m.logo}),e.jsxs("p",{className:"pt-1 text-warning small",children:[e.jsx("span",{className:"me-5",children:t("imagen_formato")}),e.jsxs("span",{className:"me-5",children:[t("imagen_peso_max"),": 1MB"]}),t("imagen_medidas_recomendadas"),": 400x400px"]})]}),e.jsx("div",{className:"mt-4 text-end",children:e.jsx(D,{disabled:p,className:"btn btn-rdn",children:p?t("procesando")+"...":t("guardar")})})]})})}function U({company:a,side:c=!1,updateRoute:g="companies.update",updateParams:d=null}){return e.jsx(T,{company:a,side:c,updateRoute:g,updateParams:d})}export{U as default};
