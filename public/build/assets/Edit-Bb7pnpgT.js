import{r as n,j as e,A as L,X as O,G as K,S as P}from"./app-DRj95fl3.js";import{A as q}from"./AdminAuthenticatedLayout-Bvk28IJ_.js";import"./Header-sOAC_5kI.js";import"./react-tooltip.min-B6vStgXO.js";import"./ColorPicker-BUmN0cM2.js";import"./TextInput-DHZ4LhQ-.js";import"./SelectInput-CcScNE44.js";import{T as G}from"./Tabs-BWc7QsVQ.js";import"./draftjs-to-html-McVxu4cf.js";import"./useSweetAlert-D-bXTlQV.js";import{u as A}from"./useTranslation-BmHTxgDU.js";import{I as E}from"./InfoPopover-DBtQ7ev6.js";import{R as X}from"./ModalTemplate-Y_YppmN-.js";import{I as M}from"./InputError-DR469WsC.js";import $ from"./ModuleTab-Bbuf24-1.js";import B from"./FunctionalitiesTab-LQt1XZWJ.js";import"./Sidebar-Cs0Qbv6j.js";import"./bootstrap.bundle.min-CIHLONa7.js";import"./NavLink-B2TCDQIx.js";import"./Dropdown-CxSOcthg.js";import"./transition-MDSzoOOX.js";import"./OverlayTrigger-BXbmHDr2.js";import"./floating-ui.dom-CQJTMakY.js";import"./Checkbox-pg3dOide.js";import"./PrimaryButton-CT79ceK8.js";import"./Textarea-BCdI17ie.js";import"./useTableManagement-4XK40PxX.js";import"./es-D0X2UUFm.js";import"./TableExporter-Cf6Xvvy9.js";import"./FileSaver.min-Bs0fFUdx.js";import"./typeof-QjJsDpFa.js";import"./Table-CUvKlSmp.js";function H({show:h,onClose:b,onCreate:c,moduleId:j}){const t=A(),[a,u]=n.useState({name:"",label:""}),[d,p]=n.useState({}),[o,r]=n.useState(!1),s=l=>{const{name:i,value:v}=l.target;u(g=>{const f={...g,[i]:v};return console.log("form state:",f),f})},S=()=>{const l={};if(a.name||(l.name=t("campo_obligatorio")),a.label||(l.label=t("campo_obligatorio")),Object.keys(l).length>0){p(l);return}r(!0),L.post(route("functionalities.store"),{...a,module_id:j},{preserveScroll:!0,onSuccess:i=>{u({name:"",label:""}),p({}),b(),typeof c=="function"&&c()},onError:i=>{p(i)},onFinish:()=>r(!1)})};return e.jsxs(X,{show:h,onClose:b,onConfirm:S,title:t("funcionalidad_nueva"),confirmText:t(o?"guardando":"guardar"),cancelText:t("cancelar"),children:[e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"position-relative",children:[e.jsxs("label",{className:"form-label",children:[t("funcionalidad"),"*"]}),e.jsx("input",{type:"text",name:"name",className:"form-control",value:a.name,onChange:s,autoComplete:"off",maxLength:100}),e.jsx(E,{code:"functionality-name"}),e.jsx(M,{message:d.name})]})}),e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"position-relative",children:[e.jsxs("label",{className:"form-label",children:[t("etiqueta"),"*"]}),e.jsx("input",{type:"text",name:"label",className:"form-control",value:a.label,onChange:s,autoComplete:"off",maxLength:100}),e.jsx(E,{code:"functionality-label"}),e.jsx(M,{message:d.label})]})})]})}function Ae({auth:h,session:b,title:c,subtitle:j,module_data:t,tab:a,levels:u,functionalities:d,availableLocales:p}){var T;const o=A(),r=((T=O())==null?void 0:T.props)||{};r.locale,r.languages;const s=r.permissions||{},[S,l]=n.useState(a||"module"),i=Object.entries(u||{}).map(([m,D])=>({value:m,label:D})),{data:v,setData:g,put:f,errors:w,processing:_}=K({name:t.name||"",level:t.level||"",label:t.label||"",icon:t.icon||"",color:t.color||"",status:t.status,explanation:t.explanation||""});function N(m){m.preventDefault(),f(route("modules.update",t.id),{preserveScroll:!0,onSuccess:()=>console.log("Movimiento actualizado")})}const[I,C]=n.useState(!1),[J,Q]=n.useState(!1),[U,V]=n.useState(null),k=()=>C(!0),z=()=>C(!1),[F,R]=n.useState(0),y=()=>R(m=>m+1),x=[];return s!=null&&s["modules.index"]&&x.push({text:o("modulos_volver"),icon:"la-angle-left",url:"modules.index",modal:!1}),s!=null&&s["modules.create"]&&x.push({text:o("modulo_nuevo"),icon:"la-plus",url:"modules.create",modal:!1}),s!=null&&s["modules.edit"]&&x.push({text:o("funcionalidad_nueva"),icon:"la-plus",url:"",modal:!0,onClick:k}),e.jsxs(q,{user:h.user,title:c,subtitle:j,actions:x,children:[e.jsx(P,{title:c}),e.jsxs("div",{className:"contents pb-4",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-12",children:e.jsxs("h2",{className:"d-flex align-items-center gap-2",children:[o("modulo"),t.icon&&e.jsx("i",{className:`la la-${t.icon} text-muted`,style:{fontSize:"1.2em"}}),e.jsx("u",{children:o(t.label)})]})}),e.jsxs("div",{className:"col-12 mt-2 mb-4",children:[e.jsxs("span",{className:"text-muted me-5",children:[o("creado"),": ",e.jsx("strong",{children:t.formatted_created_at})]}),t.created_by_name&&e.jsxs("span",{className:"text-muted me-5",children:[o("creado_por"),": ",e.jsx("strong",{children:t.created_by_name})]}),e.jsxs("span",{className:"text-muted me-5",children:[o("actualizado"),": ",e.jsx("strong",{children:t.formatted_updated_at})]}),t.updated_by_name&&e.jsxs("span",{className:"text-muted me-5",children:[o("actualizado_por"),": ",e.jsx("strong",{children:t.updated_by_name})]})]})]}),e.jsx(G,{tabs:[{key:"module",label:o("modulo"),content:e.jsx("form",{onSubmit:N,children:e.jsx($,{data:v,setData:g,errors:w,levelsArray:i,processing:_,handleSubmit:N})})},{key:"functionalities",label:o("funcionalidades"),content:e.jsx(B,{module_data:t,functionalities:d,onCreated:y,onDeleted:y,refreshKey:F},F)}],defaultActive:a}),e.jsx(H,{show:I,onClose:z,onCreate:y,moduleId:t.id})]})]})}export{Ae as default};
